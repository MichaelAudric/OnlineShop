# OnlineShop

学号：202269990049
姓名：Michael Audric Tehnika

===================================================================================================================================================================================================================

- shopping-app/src/App.js:
  这是一个用 React 和 React Router 构建的应用程序代码，主要用于实现前端的路由功能。
  代码首先导入了所需的依赖库，包括 React 和 React Router Dom。react 是构建用户界面的核心库，而 react-router-dom 是一个专为 React 提供的路由管理工具，用于在单页应用（SPA）中实现页面切换的功能。此外，还导入了五个页面组件：Home、Cart、OrderHistory、Login 和 Logout，它们分别代表不同的页面内容。
  App 组件是整个应用的核心部分，定义了应用的路由逻辑。通过使用 Router 组件，整个路由系统被包裹在一个统一的上下文中。Routes 组件则具体定义了路径与页面组件之间的映射关系。例如，/ 路径映射到 Home 页面，/cart 路径映射到购物车页面 Cart，而 /order-history 路径则指向订单历史页面 OrderHistory，类似地，/login 和 /logout 分别对应登录和登出页面。
  # 最后，代码通过 export default 导出 App 组件，使其可以被其他模块引入并使用。这个结构使得应用可以根据不同的 URL 路径动态加载对应的页面，从而为用户提供无刷新切换的流畅体验。

===================================================================================================================================================================================================================

- shopping-app/src/pages/Home.js:
  这是一个使用 React 构建的电商应用首页组件代码，包含了登录、注册、商品展示以及页面导航等功能。代码通过导入 React 的核心功能如 useState 和 useEffect，结合 Axios 进行 HTTP 请求处理，同时利用 Bootstrap 提供了简洁的页面样式。此外，还使用了 React Router 提供的 useNavigate 实现页面的无刷新跳转。
  组件中定义了多个状态变量，包括 products 用于存储从后端获取的商品列表，isLoggedIn 用于判断用户是否登录，username、password 和 email 用于存储用户输入信息，以及 loggedInUserID 用于记录当前登录用户的唯一标识。在组件加载时，使用 useEffect 钩子调用 Axios 从服务器端获取商品数据，并将数据存储到状态中以便在页面上展示。
  代码实现了多个功能函数，包括处理用户的登录和注册操作，以及处理用户登出后状态的清理。在登录时，组件会将用户名和密码提交到后端，验证通过后更新登录状态并存储用户 ID。注册功能则通过将用户名、密码和邮箱信息发送到服务器来完成账户的创建，同时在注册成功后提示用户可以登录。登出功能会将所有登录相关的信息清空，并重置用户输入。
  在渲染逻辑上，组件根据用户是否登录显示不同的内容。如果用户未登录，页面会展示登录和注册的表单，用户可以输入相应信息完成操作。如果用户已登录，则页面会展示商品列表，同时提供跳转到订单历史页面和购物车页面的按钮。此外，用户还可以通过点击登出按钮退出登录并返回初始状态。
  # 整体来看，这个组件为电商应用的首页提供了完整的功能，包括用户身份验证和基础的购物功能。它通过组件化设计和状态管理，结合后端交互，实现了清晰且直观的用户体验。

===================================================================================================================================================================================================================

- shopping-app/src/pages/Cart.js:
  这段代码实现了一个购物车组件，允许用户查看其购物车内容、删除商品以及完成支付操作。以下是具体说明。

  组件首先导入了 React 的核心功能，包括 useEffect 和 useState，以及 React Router 提供的 useLocation 用于接收导航时传递的 userID 参数。Axios 被用来与后端交互，通过 HTTP 请求获取或更新购物车数据。

  购物车的内容通过 cartItems 状态变量存储，而购物车的总金额通过 totalPrice 状态变量计算和存储。在组件加载时，利用 useEffect 钩子，根据接收到的 userID 从后端获取购物车中的商品数据。如果获取成功，数据会被保存到状态中，并调用一个计算总金额的函数对总价进行计算。如果请求失败，则将购物车内容设置为空。

  商品总价的计算通过遍历购物车中的所有商品，根据每个商品的单价和数量累加得出。组件还实现了一个删除功能，通过调用后端的删除接口，从数据库中移除指定商品，并更新前端的购物车内容和总价。

  支付功能允许用户将购物车中的商品移至订单历史记录。点击支付按钮后，组件会向后端发送支付请求，如果成功，组件会清空购物车内容并重置总金额，同时弹出支付成功的提示。如果支付失败，则会显示错误信息，提示用户重试。

  在用户界面方面，组件根据购物车的状态进行渲染。如果购物车为空，会显示提示信息。如果购物车有内容，则会通过一个列表展示每件商品的名称、价格和数量，并提供删除按钮。页面底部显示购物车总金额，以及一个支付按钮，用户点击后可以完成支付操作。

  # 总体来说，该组件通过与后端的交互，结合 React 的状态管理，提供了一个功能完整且用户体验友好的购物车模块。

===================================================================================================================================================================================================================

- shopping-app/src/pages/Login.js:
  这段代码实现了一个登录页面组件，用户可以通过该页面输入用户名和密码进行登录操作。以下是具体说明。

  组件首先通过 React 的 useState 钩子管理表单数据和错误信息。form 状态对象存储用户输入的用户名和密码，error 用于显示登录过程中的错误消息。

  当用户在输入框中输入数据时，handleChange 函数会被触发。该函数通过 e.target 获取输入框的 name 和 value 属性，并更新 form 状态的对应字段，从而实现表单数据的动态绑定。

  当用户提交表单时，handleLogin 函数会被调用。该函数通过 Axios 向后端发送一个 POST 请求，提交表单数据用于验证。后端验证成功后，返回的数据中包含用户信息，组件会将其存储到浏览器的 localStorage 中，以便后续使用。同时，弹出登录成功的提示框。如果验证失败，后端会返回相应的错误消息，组件会将其存储到 error 状态中，并在页面上显示。如果请求出错（如网络错误或服务器错误），组件会捕获异常并设置一个通用错误信息。

  在用户界面部分，组件通过表单提供了两个输入框，分别用于用户名和密码的输入。提交按钮用于提交登录请求。表单上方还显示了 error 状态的内容，用于向用户提示登录失败的原因。

  # 这段代码的优点在于其简洁明了，利用 React 的状态管理和 Axios 的网络请求功能，实现了一个基本的用户登录功能。通过 localStorage 保存登录信息也为后续的用户会话管理提供了便利。

===================================================================================================================================================================================================================

- shopping-app/src/pages/Logout.js:
  这段代码实现了一个登出功能组件。当用户访问该组件时，首先通过 useEffect 钩子清除本地存储中的用户数据，使用 localStorage.removeItem("user") 删除存储在浏览器中的用户信息。然后，使用 React Router 的 useNavigate 钩子自动将用户重定向到登录页面，确保用户登出后不能继续访问之前的页面。页面加载时会展示一个简单的文本“Logging out...”，作为用户登出过程的反馈。整个过程是自动完成的，用户无需进行任何额外操作。
  ===================================================================================================================================================================================================================

===================================================================================================================================================================================================================

- shopping-app/src/pages/OrderHistory.js:
  这段代码实现了一个“订单历史”功能组件。首先，使用 useLocation 钩子从路由中获取用户的 userID。然后，使用 useEffect 钩子在组件加载时从服务器获取该用户的订单历史信息。通过调用 Axios.get 请求数据，若成功返回数据，则将订单历史数据存储在 orderHistory 状态中。如果请求失败，捕获错误并设置一个错误消息。若 orderHistory 中没有数据，则显示“您没有订单历史”，否则会展示一个包含订单详情的列表，每个订单项都显示了 product_id 和 quantity，并用蓝色标记了数量。整个页面包含了标题和相应的订单历史内容，以及错误信息的展示。
  ===================================================================================================================================================================================================================

===================================================================================================================================================================================================================

- shopping-app/src/pages/ProductCard.js
  这个 React 组件 ProductCard 渲染了一个产品卡片，用户可以查看产品的名称、价格，并选择数量将其加入购物车。该组件接受两个属性：product 和 userID。product 属性包含产品的详细信息，如产品的 name（名称）、price（价格）和 id（产品 ID），而 userID 用于在将产品添加到购物车时标识用户。

  quantity 状态默认值为 1，message 状态用于在用户尝试将产品添加到购物车后显示成功或失败的消息。数量输入框允许用户选择大于或等于 1 的数量，任何无效的输入（例如数量小于 1）都会触发一条提示消息，告知用户该问题。

  当用户点击 "Add to Cart" 按钮时，会调用 handleAddToCart 函数。该函数首先检查所选数量是否有效。如果有效，则向后端发送 POST 请求，将产品添加到用户的购物车。如果请求成功，则显示成功消息；如果请求失败，则显示错误消息。无论成功还是失败，消息会在 3 秒后消失。

  # 卡片的样式简单，具有浅色背景、内边距和圆角。添加到购物车的按钮样式设计得既美观又实用。

===================================================================================================================================================================================================================

- api/index.js:
  这是一个基于 Express 和 MySQL 的简单后端应用，主要用于一个在线购物系统。代码通过 mysql 库连接到 MySQL 数据库 online_shop，在成功连接后输出 "MySQL Connected..."，确保与数据库的连接是成功的。

  该应用提供了多个 API 路由来处理不同的请求。首先，GET /products 路由用于返回所有产品的信息，而 GET /product/:id 路由则可以通过产品 ID 获取某个具体的产品。GET /orders 路由则是为获取特定客户的所有订单提供支持，尽管此时该功能只是一个简单的查询，没有涉及用户认证。用户注册的功能通过 POST /register 路由实现，在注册时首先检查用户名是否已经存在，如果没有，就将用户信息插入到数据库中。登录功能由 POST /login 路由提供，它会验证用户名和密码是否匹配。如果用户输入正确的用户名和密码，便返回用户信息。

  在购物车相关的功能中，POST /cart 路由允许用户向购物车中添加商品，或者在商品已经存在的情况下更新其数量。GET /cart/:userId 路由则用于获取指定用户的购物车商品。而 DELETE /cart/:userId/:productId 路由则允许用户从购物车中删除特定商品。此外，支付功能由 POST /cart/pay/:userID 路由处理，该路由会将购物车中的所有商品移到订单历史中，并清空购物车。最后，GET /orderHistory/:userID 路由用于获取指定用户的订单历史。

  # 整个系统的主要目的是提供基本的注册、登录、购物车管理和订单管理功能。每个功能的实现都围绕着用户身份和购物体验，确保用户能够顺利地注册、登录、管理购物车、完成支付并查看订单历史。
